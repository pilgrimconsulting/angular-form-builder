(function(){var a;a=function(a,b){var c,d;for(c in a)d=a[c],"$$hashKey"!==c&&(b[c]=d)},angular.module("builder.controller",["builder.provider"]).controller("fbFormObjectEditableController",["$scope","$injector",function(b,c){var d;return d=c.get("$builder"),b.setupScope=function(c){var e;return a(c,b),b.optionsText=c.options.join("\n"),b.$watch("[label, show_label, description, placeholder, required, inline, options, validation, text, header, footer, align, style, components]",function(){return c.label=b.label,c.show_label=b.show_label,c.description=b.description,c.placeholder=b.placeholder,c.required=b.required,c.inline=b.inline,c.options=b.options,c.validation=b.validation,c.text=b.text,c.header=b.header,c.footer=b.footer,c.align=b.align,c.style=b.style,c.components=b.components},!0),b.$watch("optionsText",function(a){var c;return b.options=function(){var b,d,e,f;for(e=a.split("\n"),f=[],b=0,d=e.length;b<d;b++)c=e[b],c.length>0&&f.push(c);return f}(),b.inputText=b.options[0]}),e=d.components[c.component],b.validationOptions=e.validationOptions},b.data={model:null,backup:function(){return this.model={label:b.label,show_label:b.show_label,description:b.description,placeholder:b.placeholder,required:b.required,inline:b.inline,optionsText:b.optionsText,validation:b.validation,text:b.text,header:b.header,footer:b.footer,align:b.align,style:b.style,components:b.components}},rollback:function(){if(this.model)return b.label=this.model.label,b.show_label=this.model.show_label,b.description=this.model.description,b.placeholder=this.model.placeholder,b.required=this.model.required,b.inline=this.model.inline,b.optionsText=this.model.optionsText,b.validation=this.model.validation,b.text=this.model.text,b.header=this.model.header,b.footer=this.model.footer,b.align=this.model.align,b.style=this.model.style,b.components=this.model.components}}}]).controller("fbComponentsController",["$scope","$injector",function(a,b){var c;return c=b.get("$builder"),a.selectGroup=function(b,d){var e,f,g,h;null!=b&&b.preventDefault(),a.activeGroup=d,a.components=[],g=c.components,h=[];for(f in g)e=g[f],e.group===d&&h.push(a.components.push(e));return h},a.addComponentToEnd=function(a,b){return null!=a&&a.preventDefault(),console.log(b.group,b.name),c.addFormObject(c.currentForm||0,{component:b.name})},a.groups=c.groups,a.activeGroup=a.groups[0],a.allComponents=c.components,a.$watch("allComponents",function(){return a.selectGroup(null,a.activeGroup)})}]).controller("fbComponentController",["$scope",function(b){return b.copyObjectToScope=function(c){return a(c,b)}}]).controller("fbFormController",["$scope","$injector",function(a,b){var c,d;return c=b.get("$builder"),d=b.get("$timeout"),a.currentForm=c.currentForm,null==a.input&&(a.input=[]),a.$watch("form",function(){return a.input.length>a.form.length&&a.input.splice(a.form.length),d(function(){return a.$broadcast(c.broadcastChannel.updateInput)})},!0)}]).controller("fbFormObjectController",["$scope","$injector",function(b,c){var d;return d=c.get("$builder"),b.copyObjectToScope=function(c){return a(c,b)},b.updateInput=function(a){var c;return c={id:b.formObject.id,label:b.formObject.label,show_label:b.formObject.show_label,value:null!=a?a:""},b.$parent.input.splice(b.$index,1,c)}}]).controller("PaginationController",["$scope","$injector",function(a,b){var c;return c=b.get("$builder"),console.log(c.forms),a.prev=!1,a.next=!1,a.updatePage=function(){var b,d,e;if(console.log("update"),b=0,d=c.forms,"number"==typeof d.length)b=d.length;else for(e in d)d.hasOwnProperty(e)&&++b;return a.pageCount=b,a.pages=d,a.currentPage=c.currentForm,a.prev=c.currentForm>0,a.next=a.pageCount>c.currentForm+1},a.addPage=function(b){return c.forms[a.pageCount]=[],a.updatePage()},a.deletePage=function(b){var d,e,f,g;if(e=c.forms,d=e[b+1]?b+1:b-1,console.log(b,e,d),"number"==typeof e.length)e.splice(b,1);else{delete e[b];for(f in e)g=e[f],f>b&&(e[f-1]=e[f]);delete e[a.pageCount-1]}return c.currentForm=d>b?b:d,a.currentPage=!1,a.currentPage=b},a.goPage=function(b){return console.log("GO PAGE",b,c.currentForm,c.forms),!!c.forms[b]&&(c.currentForm=b,a.updatePage(),!0)},a.goF=function(){var b;return b=c.currentForm+1,a.goPage(b)},a.goB=function(){var b;return b=c.currentForm-1,a.goPage(b)},a.updatePage()}])}).call(this),function(){angular.module("builder.directive",["builder.provider","builder.controller","builder.drag","validator"]).directive("fbSection",["$injector",function(a){var b,c;return b=a.get("$builder"),c=a.get("$drag"),{restrict:"A",scope:{fbSection:"=",fbSectionObjectEditable:"="},template:"<div class='fb-section-object-editable'>\n\t<div class='fb-section-object-editable' ng-repeat=\"object in sectionObjects\" fb-form-object-editable=\"object\" fb-draggable='allow'>\n\t</div>\n</div>",link:function(a,d,e){var f;return $(d).addClass("fb-section"),f=$(d).closest(".fb-form-object-editable").index(),a.sectionObjects=b.getSectionObjects(f),c.droppable($(d),{move:function(a){var b,c,e,f,g,h,i,j,k,l,m,n;if(f&&($("div.fb-section-object-editable").popover("hide"),f=!1),e=$(d).find(".fb-section-object-editable:not(.empty,.dragging)"),0===e.length)return void(0===$(d).find(".fb-section-object-editable.empty").length&&$(d).find(">div:first").append($("<div class='fb-section-object-editable empty'></div>")));for(j=[],j.push(-1e3),h=k=0,m=e.length;k<m;h=k+=1)c=$(e[h]),i=c.offset(),g=c.height(),j.push(i.top+g/2);for(j.push(j[j.length-1]+1e3),h=l=1,n=j.length;l<n;h=l+=1)if(a.pageY>j[h-1]&&a.pageY<=j[h]){$(d).find(".empty").remove(),b=$("<div class='fb-section-object-editable empty'></div>"),h-1<e.length?b.insertBefore($(e[h-1])):b.insertAfter($(e[h-2]));break}},out:function(){var a;return a&&($("div.fb-section-object-editable").popover("hide"),a=!1),$(d).find(".empty").remove()},up:function(e,g,h){var i,j,k,l;return i=!0,c.isMouseMoved()?(g||"drag"!==h.mode?g&&("mirror"===h.mode&&(b.insertSectionObject(b.currentForm,f,$(d).find(".empty").index(".fb-section-object-editable"),{component:h.object.componentName}),a.sectionObjects=b.getSectionObjects(f)),"drag"===h.mode&&(l=h.object.formObject.index,k=$(d).find(".empty").index(".fb-section-object-editable"),l<k&&k--,b.updateFormObjectIndex(a.formNumber,l,k))):(j=h.object.formObject,j.editable&&b.removeFormObject(attrs.fbBuilder,j.index)),$(d).find(".empty").remove()):void $(d).find(".empty").remove()}})}}}]).directive("fbBuilder",["$injector",function(a){var b,c;return b=a.get("$builder"),c=a.get("$drag"),{restrict:"A",scope:{fbBuilder:"="},template:"<div class='form-horizontal' fb-page={{currentPage}}>\n\t<div class='fb-form-object-editable ' ng-repeat=\"object in formObjects\"\n\t\tfb-form-object-editable=\"object\" fb-draggable='allow'></div>\n</div>",controller:"PaginationController",link:function(a,d,e){var f,g,h,i,j,k,l;return a.formNumber=e.fbPage||b.currentForm,null==(k=b.forms)[l=a.formNumber]&&(k[l]=[]),a.formObjects=b.forms[a.formNumber],i=!0,a.currentPage=1,a.$watchGroup([function(){return b.forms[b.currentForm]},function(){return b.forms.length}],function(c,d){return console.log(arguments,"page change -> change pagin",b.currentForm),a.formNumber=b.currentForm,a.currentPage=b.currentForm,a.formObjects=b.forms[a.formNumber]}),$(d).addClass("fb-builder"),h="Alt",j="",f=function(a){return function(a){var b,c;switch(b=window.event?event.keyCode:a.keyCode){case 18:c="Alt";break;case 17:c="Ctrl"}return j=c,console.log(j)}}(this),g=function(a){return function(a){var b,c;switch(b=window.event?event.keyCode:a.keyCode){case 18:c="Alt";break;case 17:c="Ctrl"}return j===c&&(j=""),console.log("UP",j)}}(this),document.onkeydown=f,document.onkeyup=g,c.droppable($(d),{move:function(a){var b,c,e,f,g,k,l,m,n,o,p;if(i&&($("div.fb-form-object-editable").popover("hide"),i=!1),j===h){if(e=$(d).find(".fb-form-object-editable:not(.empty,.dragging)"),0===e.length)return void(0===$(d).find(".fb-form-object-editable.empty").length&&$(d).find(">div:first").append($("<div class='fb-form-object-editable empty'></div>")));for(l=[],l.push(-1e3),g=m=0,o=e.length;m<o;g=m+=1)c=$(e[g]),k=c.offset(),f=c.height(),l.push(k.top+f/2);for(l.push(l[l.length-1]+1e3),g=n=1,p=l.length;n<p;g=n+=1)if(a.pageY>l[g-1]&&a.pageY<=l[g]){$(d).find(".empty").remove(),b=$("<div class='fb-form-object-editable empty'></div>"),g-1<e.length?b.insertBefore($(e[g-1])):b.insertAfter($(e[g-2]));break}}},out:function(){return i&&($("div.fb-form-object-editable").popover("hide"),i=!1),$(d).find(".empty").remove()},up:function(f,g,k){var l,m,n;if(i=!0,j===h)return c.isMouseMoved()?(g||"drag"!==k.mode?g&&("mirror"===k.mode&&b.insertFormObject(a.formNumber,$(d).find(".empty").index(".fb-form-object-editable"),{component:k.object.componentName}),"drag"===k.mode&&(n=k.object.formObject.index,m=$(d).find(".empty").index(".fb-form-object-editable"),n<m&&m--,b.updateFormObjectIndex(a.formNumber,n,m))):(l=k.object.formObject,l.editable&&b.removeFormObject(e.fbBuilder,l.index)),$(d).find(".empty").remove()):void $(d).find(".empty").remove()}})}}}]).directive("fbFormObjectEditable",["$injector",function(a){var b,c,d,e;return b=a.get("$builder"),d=a.get("$drag"),c=a.get("$compile"),e=a.get("$validator"),{restrict:"A",controller:"fbFormObjectEditableController",scope:{isOpen:"=isOpen",formObject:"=fbFormObjectEditable"},link:function(a,f){var g,h;if(a.inputArray=[],a.$component=b.components[a.formObject.component],a.setupScope(a.formObject),a.$watch("$component.template",function(b){var d;if(b)return d=c(b)(a),$(f).html(d),console.log("Component change")}),$(f).on("click",function(){return!1}),console.log(a.$component.name,a.isOpen),g="section"!==a.$component.name,d.draggable($(f),{object:{formObject:a.formObject}}),a.formObject.editable)return h={},a.$watch("$component.popoverTemplate",function(d){if(d)return $(f).removeClass(h.id),h={id:"fb-"+Math.random().toString().substr(2),isClickedSave:!1,view:null,html:d},h.html=$(h.html).addClass(h.id),h.view=c(h.html)(a),$(f).addClass(h.id),$(f).popover({html:!0,title:a.$component.label,content:h.view,container:"body",placement:b.config.popoverPlacement})}),a.popover={save:function(b){b.preventDefault(),e.validate(a).success(function(){return h.isClickedSave=!0,$(f).popover("hide")})},remove:function(c){c.preventDefault(),b.removeFormObject(a.$parent.formNumber,a.$parent.$index),$(f).popover("hide")},shown:function(){return a.data.backup(),h.isClickedSave=!1},cancel:function(b){a.data.rollback(),b&&(b.preventDefault(),$(f).popover("hide"))}},$(f).on("show.bs.popover",function(){var a,b,c;return!d.isMouseMoved()&&($("div.fb-form-object-editable:not(."+h.id+")").popover("hide"),a=$("form."+h.id).closest(".popover"),a.length>0?(b=$(f).offset().top+$(f).height()/2,c=b-a.height()/2,a.css({position:"absolute",top:c}),a.show(),setTimeout(function(){return a.addClass("in"),$(f).triggerHandler("shown.bs.popover")},0),!1):void 0)}),$(f).on("shown.bs.popover",function(){$(".popover ."+h.id+" input:first").select(),a.$apply(function(){return a.popover.shown()})}),$(f).on("hide.bs.popover",function(){var b;return b=$("form."+h.id).closest(".popover"),h.isClickedSave||(a.$$phase||a.$root.$$phase?a.popover.cancel():a.$apply(function(){return a.popover.cancel()})),b.removeClass("in"),setTimeout(function(){return b.hide()},300),!1})}}}]).directive("fbSectionObjectEditable",["$injector",function(a){var b,c,d,e;return b=a.get("$builder"),d=a.get("$drag"),c=a.get("$compile"),e=a.get("$validator"),{restrict:"A",controller:"fbFormObjectEditableController",scope:{formObject:"=fbFormObjectEditable"},link:function(a,f){var g;if(a.inputArray=[],a.$component=b.components[a.formObject.component],a.setupScope(a.formObject),a.$watch("$component.template",function(b){var d;if(b)return d=c(b)(a),$(f).html(d)}),$(f).on("click",function(){return!1}),console.log($(f).attr("fb-draggable")),"allow"===$(f).attr("fb-draggable")&&d.draggable($(f),{object:{formObject:a.formObject}}),a.formObject.editable)return g={},a.$watch("$component.popoverTemplate",function(d){if(d)return $(f).removeClass(g.id),g={id:"fb-"+Math.random().toString().substr(2),isClickedSave:!1,view:null,html:d},g.html=$(g.html).addClass(g.id),g.view=c(g.html)(a),$(f).addClass(g.id),$(f).popover({html:!0,title:a.$component.label,content:g.view,container:"body",placement:b.config.popoverPlacement})}),a.popover={save:function(b){b.preventDefault(),e.validate(a).success(function(){return g.isClickedSave=!0,$(f).popover("hide")})},remove:function(c){c.preventDefault(),b.removeFormObject(a.$parent.formNumber,a.$parent.$index),$(f).popover("hide")},shown:function(){return a.data.backup(),g.isClickedSave=!1},cancel:function(b){a.data.rollback(),b&&(b.preventDefault(),$(f).popover("hide"))}},$(f).on("show.bs.popover",function(){var a,b,c;return!d.isMouseMoved()&&($("div.fb-section-object-editable:not(."+g.id+")").popover("hide"),a=$("form."+g.id).closest(".popover"),a.length>0?(b=$(f).offset().top+$(f).height()/2,c=b-a.height()/2,a.css({position:"absolute",top:c}),a.show(),setTimeout(function(){return a.addClass("in"),$(f).triggerHandler("shown.bs.popover")},0),!1):void 0)}),$(f).on("shown.bs.popover",function(){$(".popover ."+g.id+" input:first").select(),a.$apply(function(){return a.popover.shown()})}),$(f).on("hide.bs.popover",function(){var b;return b=$("form."+g.id).closest(".popover"),g.isClickedSave||(a.$$phase||a.$root.$$phase?a.popover.cancel():a.$apply(function(){return a.popover.cancel()})),b.removeClass("in"),setTimeout(function(){return b.hide()},300),!1})}}}]).directive("fbComponents",["$injector",function(a){return{restrict:"A",template:'<ul ng-if="groups.length > 1" class="nav nav-tabs nav-justified">\n\t<li ng-repeat="group in groups" ng-class="{active:activeGroup==group}">\n\t\t<a href=\'#\' ng-click="selectGroup($event, group)">{{group}}</a>\n\t</li>\n</ul>\n<div class=\'form-horizontal col-sm-12 elementList\'>\n\t<div ng-repeat="component in components">\n\t\t<div class="form-group element-wrapper">\n\t\t\t<div class="col-sm-1">{{component.name}}\n\t\t\t\t<button type=\'button\' class=\'btn btn-success btn-sm\'\n\t\t\t\t\t\tng-click=\'addComponentToEnd($event, component)\'>+</button>\n\t\t\t</div>\n\t\t\t<div class="col-sm-11">\n\t\t\t\t<div class=\'fb-component\' fb-component="component" ng-component="{{component.name}}"></div>\n\t\t\t</div>\n\t</div>\n</div>',controller:"fbComponentsController"}}]).directive("fbComponent",["$injector",function(a){var b,c,d;return b=a.get("$builder"),d=a.get("$drag"),c=a.get("$compile"),{restrict:"A",scope:{component:"=fbComponent"},controller:"fbComponentController",link:function(a,b){return a.copyObjectToScope(a.component),d.draggable($(b),{mode:"mirror",defer:!1,object:{componentName:a.component.name}}),a.$watch("component.template",function(d){var e;if(d)return e=c(d)(a),$(b).html(e)})}}}]).directive("fbForm",["$injector",function(a){return{restrict:"A",require:"ngModel",scope:{formNumber:"@fbForm",input:"=ngModel",default:"=fbDefault"},template:'<div class=\'fb-form-object\' ng-repeat="object in form" fb-form-object="object"></div>',controller:"fbFormController",link:function(b,c,d){var e,f,g;return e=a.get("$builder"),b.$watch(function(){return e.currentForm},function(a,c){var d,f;return console.log(arguments,"page change"),b.formNumber=a,null==(d=e.forms)[f=b.formNumber]&&(d[f]=[]),b.form=e.forms[b.formNumber]}),null==(f=e.forms)[g=b.formNumber]&&(f[g]=[]),b.form=e.forms[b.formNumber]}}}]).directive("fbFormObject",["$injector",function(a){var b,c,d;return b=a.get("$builder"),c=a.get("$compile"),d=a.get("$parse"),{restrict:"A",controller:"fbFormObjectController",link:function(a,e,f){return a.formObject=d(f.fbFormObject)(a),a.$component=b.components[a.formObject.component],a.$on(b.broadcastChannel.updateInput,function(){return a.updateInput(a.inputText)}),a.$component.arrayToText&&(a.inputArray=[],a.$watch("inputArray",function(b,c){var d,e,f;if(b!==c){d=[];for(e in a.inputArray)a.inputArray[e]&&d.push(null!=(f=a.options[e])?f:a.inputArray[e]);return a.inputText=d.join(", ")}},!0)),a.$watch("inputText",function(){return a.updateInput(a.inputText)}),a.$watch(f.fbFormObject,function(){return a.copyObjectToScope(a.formObject)},!0),a.$watch("$component.template",function(b){var d,f,g;if(b)return f=$(b),d=f.find("[ng-model='inputText']"),d.attr({validator:"{{validation}}"}),g=c(f)(a),$(e).html(g)}),!a.$component.arrayToText&&a.formObject.options.length>0&&(a.inputText=a.formObject.options[0]),a.$watch("default['"+a.formObject.id+"']",function(b){if(b)return a.$component.arrayToText?a.inputArray=b:a.inputText=b})}}}]).directive("fbPages",["$injector",function(a){var b;return b=a.get("$builder"),{restrict:"A",template:'<div class="fb-builderPagination">\n\t<div class="pull-left">\n\t\t<button type="button" class="btn btn-primary btn-small _pull-right"\n\t\t\t\tng-class="{disabled: !currentPage}" ng-click="goB()"><</button>\n\t\t<button type="button" class="btn btn-primary btn-small _pull-right"\n\t\t\t\tng-class="{disabled: !next}" ng-click="goF()">></button>\n\t\t<div class="btn-group">\n\t\t\t<button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown"\n\t\t\t\t\taria-expanded="false" aria-haspopup="true">Page\n\t\t\t\t<span class="caret"></span>\n\t\t\t\t<span class="sr-only">Toggle Dropdown</span>\n\t\t\t</button>\n\t\t\t<ul class="dropdown-menu" >\n\t\t\t\t<li ng-repeat="(key, value) in pages"><a ng-click="goPage(+key)">{{+key+1}}</a></li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t<span class="panel-title" >\n\t\tPage <b>#<span ng-model="page">{{currentPage+1}}</span></b> / {{pageCount}}\n\t</span>\n\n\t<div class="pull-right">\n\t\t<button type="button" class="btn btn-danger btn-small _pull-right disabled"\n\t\t\t\tng-class="{disabled: pageCount == 1}" ng-click="deletePage(currentPage)">-</button>\n\t\t<!-- Split button -->\n\t\t<div class="btn-group">\n\t\t\t<button type="button" class="btn btn-success" ng-click="addPage(pageCount)">Add</button>\n\t\t\t<button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown"\n\t\t\t\t\taria-haspopup="true" aria-expanded="false">\n\t\t\t\t<span class="caret"></span>\n\t\t\t\t<span class="sr-only">Toggle Dropdown</span>\n\t\t\t</button>\n\t\t\t<ul class="dropdown-menu">\n\t\t\t\t<li><a href="" ng-click="addPage(pageCount)">Page</a></li>\n\t\t\t\t<li role="separator" class="divider"></li>\n\t\t\t\t<li><a href="">Section</a></li>\n\t\t\t\t<li><a href="">Component</a></li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\n\t<div class="clearfix"></div>\n</div>',controller:"PaginationController",link:function(a,c,d){return a.$watch(function(){return b.forms.length},function(){return console.log(arguments,"change pagination"),a.pageCount=b.forms.length,a.pages=b.forms,a.currentPage=b.currentForm})}}}])}.call(this),function(){angular.module("builder.drag",[]).provider("$drag",function(){var a,b,c;a=null,b=null,this.data={draggables:{},droppables:{}},this.mouseMoved=!1,this.isMouseMoved=function(a){return function(){return a.mouseMoved}}(this),this.hooks={down:{},move:{},up:{}},this.innerDropHover=!1,this.eventMouseMove=function(){},this.eventMouseUp=function(){},$(function(a){return function(){return $(document).on("mousedown",function(b){var c,d,e;a.mouseMoved=!1,e=a.hooks.down;for(d in e)(c=e[d])(b)}),$(document).on("mousemove",function(b){var c,d,e;a.mouseMoved=!0,e=a.hooks.move;for(d in e)(c=e[d])(b)}),$(document).on("mouseup",function(b){var c,d,e;e=a.hooks.up;for(d in e)(c=e[d])(b)})}}(this)),this.currentId=0,this.getNewId=function(a){return function(){return""+a.currentId++}}(this),this.setupEasing=function(){return jQuery.extend(jQuery.easing,{easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c}})},this.setupProviders=function(c){return a=c,b=a.get("$rootScope")},this.isHover=function(a){return function(a,b){var c,d,e,f,g;return d=a.offset(),e=b.offset(),f={width:a.width(),height:a.height()},g={width:b.width(),height:b.height()},c={x:!1,y:!1},c.x=d.left>e.left&&d.left<e.left+g.width,c.x=c.x||d.left+f.width>e.left&&d.left+f.width<e.left+g.width,!!c&&(c.y=d.top>e.top&&d.top<e.top+g.height,c.y=c.y||d.top+f.height>e.top&&d.top+f.height<e.top+g.height,c.x&&c.y)}}(this),c=function(a,b){return setTimeout(function(){return b()},a)},this.autoScroll={up:!1,down:!1,scrolling:!1,scroll:function(a){return function(){return a.autoScroll.scrolling=!0,a.autoScroll.up?($("html, body").dequeue().animate({scrollTop:$(window).scrollTop()-50},100,"easeOutQuad"),c(100,function(){return a.autoScroll.scroll()})):a.autoScroll.down?($("html, body").dequeue().animate({scrollTop:$(window).scrollTop()+50},100,"easeOutQuad"),c(100,function(){return a.autoScroll.scroll()})):a.autoScroll.scrolling=!1}}(this),start:function(a){return function(b){if(b.clientY<50){if(a.autoScroll.up=!0,a.autoScroll.down=!1,!a.autoScroll.scrolling)return a.autoScroll.scroll()}else{if(!(b.clientY>$(window).innerHeight()-50))return a.autoScroll.up=!1,a.autoScroll.down=!1;if(a.autoScroll.up=!1,a.autoScroll.down=!0,!a.autoScroll.scrolling)return a.autoScroll.scroll()}}}(this),stop:function(a){return function(){return a.autoScroll.up=!1,a.autoScroll.down=!1}}(this)},this.dragMirrorMode=function(a){return function(b,c,d){var e;return null==c&&(c=!0),e={id:a.getNewId(),mode:"mirror",maternal:b[0],element:null,object:d},b.on("mousedown",function(d){var f;if(d.preventDefault(),f=b.clone(),e.element=f[0],f.addClass("fb-draggable form-horizontal prepare-dragging"),a.hooks.move.drag=function(c,d){var g,h,i,j;if(!f.hasClass("prepare-dragging")||(f.css({width:b.width(),height:b.height()}),f.removeClass("prepare-dragging"),f.addClass("dragging"),!d)){f.offset({left:c.pageX-f.width()/2,top:c.pageY-f.height()/2}),a.autoScroll.start(c),i=a.data.droppables,j=[];for(h in i)g=i[h],a.isHover(f,$(g.element))?j.push(g.move(c,e)):j.push(g.out(c,e));return j}},a.hooks.up.drag=function(b){var c,d,g,h;h=a.data.droppables;for(d in h)c=h[d],g=a.isHover(f,$(c.element)),c.up(b,g,e);return delete a.hooks.move.drag,delete a.hooks.up.drag,e.element=null,f.remove(),a.autoScroll.stop()},$("body").append(f),!c)return a.hooks.move.drag(d,c)}),e}}(this),this.dragDragMode=function(a){return function(b,c,d){var e;return null==c&&(c=!0),e={id:a.getNewId(),mode:"drag",maternal:null,element:b[0],object:d},b.addClass("fb-draggable"),b.on("mousedown",function(d){if(d.preventDefault(),!b.hasClass("dragging"))return b.addClass("prepare-dragging"),a.hooks.move.drag=function(c,d){var f,g,h;if(!b.hasClass("prepare-dragging")||(b.css({width:b.width(),height:b.height()}),b.removeClass("prepare-dragging"),b.addClass("dragging"),!d)){b.offset({left:c.pageX-b.width()/2,top:c.pageY-b.height()/2}),a.autoScroll.start(c),h=a.data.droppables;for(g in h)f=h[g],a.isHover(b,$(f.element))?f.move(c,e):f.out(c,e)}},a.hooks.up.drag=function(c){var d,f,g,h;h=a.data.droppables;for(f in h)d=h[f],g=a.isHover(b,$(d.element)),d.up(c,g,e);return delete a.hooks.move.drag,delete a.hooks.up.drag,b.css({width:"",height:"",left:"",top:""}),b.removeClass("dragging defer-dragging"),a.autoScroll.stop()},c?void 0:a.hooks.move.drag(d,c)}),e}}(this),this.dropMode=function(a){return function(c,d){var e;return e={id:a.getNewId(),element:c[0],move:function(a,c){return b.$apply(function(){return"function"==typeof d.move?d.move(a,c):void 0})},up:function(a,c,e){return b.$apply(function(){return"function"==typeof d.up?d.up(a,c,e):void 0})},out:function(a,c){return b.$apply(function(){return"function"==typeof d.out?d.out(a,c):void 0})}}}}(this),this.draggable=function(a){return function(b,c){var d,e,f,g,h,i,j;if(null==c&&(c={}),f=[],"mirror"===c.mode)for(g=0,i=b.length;g<i;g++)e=b[g],d=a.dragMirrorMode($(e),c.defer,c.object),f.push(d.id),a.data.draggables[d.id]=d;else for(h=0,j=b.length;h<j;h++)e=b[h],d=a.dragDragMode($(e),c.defer,c.object),f.push(d.id),a.data.draggables[d.id]=d;return f}}(this),this.droppable=function(a){return function(b,c){var d,e,f,g,h;for(null==c&&(c={}),f=[],g=0,h=b.length;g<h;g++)e=b[g],d=a.dropMode($(e),c),f.push(d),a.data.droppables[d.id]=d;return f}}(this),this.get=function(a){return this.setupEasing(),this.setupProviders(a),{isMouseMoved:this.isMouseMoved,data:this.data,draggable:this.draggable,droppable:this.droppable,innerDropHover:this.innerDropHover}},this.get.$inject=["$injector"],this.$get=this.get})}.call(this),function(){angular.module("builder",["builder.directive"])}.call(this),function(){angular.module("app",["builder","builder.components","validator.rules"]).controller("PaginController",["$scope","$builder","$validator",function(a,b,c){return a.pages=[b.forms.default]}])}.call(this),function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};angular.module("builder.provider",[]).provider("$builder",function(){var b,c,d;c=null,b=null,d=null,this.config={popoverPlacement:"right"},this.components={},this.groups=[],this.broadcastChannel={updateInput:"$updateInput"},this.currentForm=0,this.forms=[],this.forms[0]=[],this.convertComponent=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return c={name:a,group:null!=(d=b.group)?d:"Default",label:null!=(e=b.label)?e:"",show_label:null==(n=b.show_label)||n,description:null!=(o=b.description)?o:"",placeholder:null!=(p=b.placeholder)?p:"",text:null!=(q=b.text)?q:"",header:null!=(r=b.header)?r:"",footer:null!=(s=b.footer)?s:"",style:null!=(t=b.style)?t:"",editable:null==(u=b.editable)||u,required:null!=(f=b.required)&&f,inline:null!=(g=b.inline)&&g,validation:null!=(h=b.validation)?h:"/.*/",validationOptions:null!=(i=b.validationOptions)?i:[],options:null!=(j=b.options)?j:[],align:null!=(k=b.align)?k:[],arrayToText:null!=(l=b.arrayToText)&&l,template:b.template,templateUrl:b.templateUrl,popoverTemplate:b.popoverTemplate,popoverTemplateUrl:b.popoverTemplateUrl,components:null!=(m=b.components)?m:[]},c.template||c.templateUrl||console.error("The template is empty."),c.popoverTemplate||c.popoverTemplateUrl||console.error("The popoverTemplate is empty."),c},this.convertFormObject=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(null==b&&(b={}),c=this.components[b.component],null==c)throw"The component "+b.component+" was not registered.";return d={id:b.id,component:b.component,editable:null!=(e=b.editable)?e:c.editable,index:null!=(f=b.index)?f:0,label:null!=(m=b.label)?m:c.label,show_label:null!=(n=b.show_label)?n:c.show_label,description:null!=(o=b.description)?o:c.description,placeholder:null!=(p=b.placeholder)?p:c.placeholder,options:null!=(q=b.options)?q:c.options,required:null!=(r=b.required)?r:c.required,inline:null!=(s=b.inline)?s:c.inline,validation:null!=(t=b.validation)?t:c.validation,text:null!=(g=b.text)?g:c.text,header:null!=(h=b.header)?h:c.header,footer:null!=(i=b.footer)?i:c.footer,align:null!=(j=b.align)?j:c.align,style:null!=(k=b.style)?k:c.style,components:null!=(l=b.components)?l:c.components}},this.reindexFormObject=function(a){return function(b){var c,d,e,f;for(c=a.forms[b],d=e=0,f=c.length;e<f;d=e+=1)c[d].index=d}}(this),this.reindexSectionObject=function(a){return function(b,c){var d,e,f,g;for(e=a.forms[b][c].components,d=f=0,g=e.length;f<g;d=f+=1)e[d].index=d}}(this),this.setupProviders=function(a){return function(a){return c=a,b=c.get("$http"),d=c.get("$templateCache")}}(this),this.loadTemplate=function(a){if(null==a.template&&b.get(a.templateUrl,{cache:d}).success(function(b){return a.template=b}),null==a.popoverTemplate)return b.get(a.popoverTemplateUrl,{cache:d}).success(function(b){return a.popoverTemplate=b})},this.registerComponent=function(b){return function(d,e){var f,g;null==e&&(e={}),null==b.components[d]?(f=b.convertComponent(d,e),b.components[d]=f,null!=c&&b.loadTemplate(f),g=f.group,a.call(b.groups,g)<0&&b.groups.push(f.group)):console.error("The component "+d+" was registered.")}}(this),this.addFormObject=function(a){return function(b,c){var d;return null==c&&(c={}),null==(d=a.forms)[b]&&(d[b]=[]),a.insertFormObject(b,a.forms[b].length,c)}}(this),this.insertSectionObject=function(a){return function(b,c,d,e){var f;return null==e&&(e={}),null==(f=a.forms[b][c]).components&&(f.components=[]),d>a.forms[b][c].components.length?d=a.forms[b][c].components.length:d<0&&(d=0),a.forms[b][c].components.splice(d,0,a.convertFormObject(b,e)),a.reindexSectionObject(b,c),a.forms[b][c].components[d]}}(this),this.getSectionObjects=function(a){return function(b){return a.forms[a.currentForm][b]?a.forms[a.currentForm][b].components:[]}}(this),this.insertFormObject=function(a){return function(b,c,d){var e;return null==d&&(d={}),null==(e=a.forms)[b]&&(e[b]=[]),c>a.forms[b].length?c=a.forms[b].length:c<0&&(c=0),a.forms[b].splice(c,0,a.convertFormObject(b,d)),a.reindexFormObject(b),a.forms[b][c]}}(this),this.removeFormObject=function(a){return function(b,c){var d;return d=a.forms[b],d.splice(c,1),a.reindexFormObject(b)}}(this),this.updateFormObjectIndex=function(a){return function(b,c,d){var e,f;if(c!==d)return f=a.forms[b],e=f.splice(c,1)[0],f.splice(d,0,e),a.reindexFormObject(b)}}(this),this.$get=["$injector",function(a){return function(b){var c,d,e;a.setupProviders(b),e=a.components;for(d in e)c=e[d],a.loadTemplate(c);return{config:a.config,components:a.components,groups:a.groups,forms:a.forms,currentForm:a.currentForm,broadcastChannel:a.broadcastChannel,registerComponent:a.registerComponent,addFormObject:a.addFormObject,insertFormObject:a.insertFormObject,removeFormObject:a.removeFormObject,updateFormObjectIndex:a.updateFormObjectIndex,getSectionObjects:a.getSectionObjects,insertSectionObject:a.insertSectionObject}}}(this)]})}.call(this);